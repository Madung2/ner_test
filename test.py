sentences = [
    "이순신 장군은 조선 시대의 영웅입니다.",
    "서울특별시는 한국의 수도입니다.",
    "삼성전자는 세계적인 전자회사입니다.",
    "2023년 5월 10일에 중요한 회의가 있었습니다.",
    "제 친구 이름은 김민수입니다.",
    "서울에서 부산까지는 KTX로 약 2시간 30분이 걸립니다.",
    "대한항공은 국제 항공편을 운영하는 주요 항공사입니다.",
    "정우성은 한국 영화 배우로 유명합니다.",
    "한국은행은 대한민국의 중앙은행입니다.",
    "부산광역시는 대한민국에서 두 번째로 큰 도시입니다.",
    "2024년 7월에 서울에서 중요한 행사가 열립니다.",
    "박지성은 축구 선수로서 국제적으로 유명해졌습니다.",
    "현대자동차는 한국에서 가장 큰 자동차 제조업체입니다.",
    "강남구는 서울의 부유한 지역으로 알려져 있습니다.",
    "LG전자는 가전 제품을 제조하는 대기업입니다."
]
sentences =  ['자율주행 기술 개발을 위해 삼성과 현대자동차는 긴밀한 협력을 통해 2025년까지 상용화를 목표로 하고 있으며, 이를 통해 전기차 시장에서의 우위를 다지고 있습니다.',
 '탄소 중립 목표를 달성하기 위해 포스코는 SK와 손잡고 친환경 철강 생산 공정을 개발하고 있으며, 이로 인해 글로벌 철강업계에서 선두 자리를 유지할 계획입니다.',
 '한화에서 제공하는 태양광 패널을 통해 기아자동차는 차세대 전기차에 지속 가능한 에너지를 공급할 수 있는 시스템을 구축하고 있으며, 이는 전 세계적인 친환경 트렌드에 발맞춘 행보로 평가받고 있습니다.',
 'GS는 고객 맞춤형 서비스를 제공하기 위해 CJ와 협력하여 AI 기반의 데이터 분석 시스템을 도입하고 있으며, 이를 통해 소비자들에게 더욱 개인화된 쇼핑 경험을 제공하려 하고 있습니다.',
 '4차 산업혁명 기술의 도입을 목표로 KT와 손잡은 에쓰오일은 스마트 정유 공장을 구축하고 있으며, 이를 통해 생산성 향상과 함께 에너지 효율을 극대화하고자 합니다.',
 '물류 산업의 혁신을 위해 두산과 협력한 이마트는 로봇 자동화를 도입한 물류센터를 구축하고 있으며, 이를 통해 온라인 쇼핑의 처리 속도를 획기적으로 개선할 예정입니다.',
 '롯데는 AI 기반의 고객 맞춤형 여행 서비스를 제공하기 위해 대한항공과 함께 새로운 플랫폼을 개발하고 있으며, 이를 통해 여행객들에게 보다 편리한 예약과 서비스를 제공할 계획입니다.',
 '친환경 기술에 대한 관심이 높아지는 가운데 GM Korea와 대우조선해양은 차세대 전기차와 친환경 선박 기술을 함께 개발하고 있으며, 이를 통해 전 세계 시장에서의 입지를 강화할 것으로 보입니다.',
 '네이버는 최근 카카오와 협력하여 AI 챗봇 기능을 개선하고, 사용자 경험을 극대화할 계획을 발표했습니다.',
 '쿠팡은 하림과의 협약을 통해 신선 식품 배송 서비스를 강화하고 있으며, 고객 만족도를 높이는 데 주력하고 있습니다.',
 '아모레퍼시픽은 신세계와 함께 뷰티와 라이프스타일을 결합한 새로운 복합 매장을 오픈할 예정입니다.',
 '현대자동차는 효성과의 협력을 통해 전기차 충전 인프라를 확충하고, 친환경 자동차 보급에 힘을 쏟고 있습니다.',
 '농협은 동국제약과 손잡고, 건강기능식품 개발에 착수했으며, 이를 통해 농산물의 부가가치를 높이고 있습니다.',
 '한국전력공사는 두산중공업과 협력하여 신재생 에너지를 활용한 발전소를 건설하고 있으며, 에너지 전환에 박차를 가하고 있습니다.',
 '롯데는 한국수력원자력과 함께 친환경 에너지 솔루션을 도입해 향후 탄소 중립 달성에 기여하고자 합니다.',
 '삼양은 CJ제일제당과 협력해 새로운 식품 기술을 개발하고 있으며, 이를 통해 글로벌 식품 시장 진출을 모색하고 있습니다.',
 '한온시스템은 기아와의 협력을 통해 차세대 전기차에 적용할 냉난방 시스템을 개발하고 있습니다.',
 '대한항공은 한화와 손잡고 차세대 무인 항공기 개발에 착수했으며, 글로벌 시장에서의 경쟁력을 높이기 위해 협력을 강화하고 있습니다.']

from transformers import AutoTokenizer, AutoModelForTokenClassification, pipeline
def ner_model(name_of_model):
    tokenizer = AutoTokenizer.from_pretrained(name_of_model)
    model = AutoModelForTokenClassification.from_pretrained(name_of_model)
    ner = pipeline("token-classification", model=model, tokenizer=tokenizer)
    return ner

def evaluate_models(sentences, models):
    results = []
    for model in models:
        output = model(sentences)
        results.append(output)
    for idx, sentence in enumerate(sentences):
        print(sentence)
        for idm, result in enumerate(results):
            r = result[idx]
            print(f"model {idm + 1}: ",end="")
            current = ""
            for token in r:
                current += f"{token['word']}: {token['entity']}  "
            print(current)


        print('-----------------------------------')


model_1_name = "Leo97/KoELECTRA-small-v3-modu-ner"
model_1 = ner_model(model_1_name)
model_2_name  = "FacebookAI/xlm-roberta-large-finetuned-conll03-english"
model_2 = ner_model(model_2_name)
model_3_name  = "jinwoowef/final_crf"
model_3 = ner_model(model_3_name)
evaluate_models(sentences,[model_1,model_2,model_3])


'''
자율주행 기술 개발을 위해 삼성과 현대자동차는 긴밀한 협력을 통해 2025년까지 상용화를 목표로 하고 있으며, 이를 통해 전기차 시장에서의 우위를 다지고 있습니다.
model 1: 자율: B-TR  ##주: I-TR  ##행: I-TR  기술: I-TR  삼성: B-OG  현대: B-OG  ##자동: I-OG  ##차: I-OG  2025: B-DT  ##년: I-DT  ##까: I-DT  ##지: I-DT  
model 2: ▁삼성: I-ORG  ▁현대: I-ORG  자동차: I-ORG  
model 3: 
-----------------------------------
탄소 중립 목표를 달성하기 위해 포스코는 SK와 손잡고 친환경 철강 생산 공정을 개발하고 있으며, 이로 인해 글로벌 철강업계에서 선두 자리를 유지할 계획입니다.
model 1: 탄소: B-MT  포스코: B-OG  SK: B-OG  철강: B-TM  
model 2: ▁포: I-ORG  스코: I-ORG  ▁SK: I-ORG  
model 3: 
-----------------------------------
한화에서 제공하는 태양광 패널을 통해 기아자동차는 차세대 전기차에 지속 가능한 에너지를 공급할 수 있는 시스템을 구축하고 있으며, 이는 전 세계적인 친환경 트렌드에 발맞춘 행보로 평가받고 있습니다.
model 1: 한화: B-OG  기아: B-OG  ##자동: B-AF  ##차: I-AF  
model 2: ▁한: I-ORG  화: I-ORG  ▁기: I-ORG  아: I-ORG  자동차: I-ORG  
model 3: 
-----------------------------------
GS는 고객 맞춤형 서비스를 제공하기 위해 CJ와 협력하여 AI 기반의 데이터 분석 시스템을 도입하고 있으며, 이를 통해 소비자들에게 더욱 개인화된 쇼핑 경험을 제공하려 하고 있습니다.
model 1: GS: B-OG  CJ: B-OG  AI: B-TR  
model 2: ▁GS: I-ORG  ▁C: I-ORG  J: I-ORG  ▁AI: I-MISC  
model 3: 
-----------------------------------
4차 산업혁명 기술의 도입을 목표로 KT와 손잡은 에쓰오일은 스마트 정유 공장을 구축하고 있으며, 이를 통해 생산성 향상과 함께 에너지 효율을 극대화하고자 합니다.
model 1: 4: B-CV  ##차: I-CV  산업: I-CV  ##혁명: I-CV  기술: I-TR  KT: B-OG  에: B-OG  ##쓰: I-OG  ##오: I-OG  ##일: I-OG  
model 2: ▁KT: I-ORG  ▁에: I-ORG  쓰: I-ORG  오: I-ORG  일: I-ORG  
model 3: 
-----------------------------------
물류 산업의 혁신을 위해 두산과 협력한 이마트는 로봇 자동화를 도입한 물류센터를 구축하고 있으며, 이를 통해 온라인 쇼핑의 처리 속도를 획기적으로 개선할 예정입니다.
model 1: 두산: B-OG  이마트: B-OG  로봇: B-TM  
model 2: ▁두: I-ORG  산: I-ORG  ▁이: I-ORG  마트: I-ORG  
model 3: 
-----------------------------------
롯데는 AI 기반의 고객 맞춤형 여행 서비스를 제공하기 위해 대한항공과 함께 새로운 플랫폼을 개발하고 있으며, 이를 통해 여행객들에게 보다 편리한 예약과 서비스를 제공할 계획입니다.
model 1: 롯데: B-OG  AI: B-TR  대한항공: B-OG  
model 2: ▁롯데: I-ORG  ▁대한: I-ORG  항공: I-ORG  
model 3: 
-----------------------------------
친환경 기술에 대한 관심이 높아지는 가운데 GM Korea와 대우조선해양은 차세대 전기차와 친환경 선박 기술을 함께 개발하고 있으며, 이를 통해 전 세계 시장에서의 입지를 강화할 것으로 보입니다.
model 1: GM: B-OG  Korea: I-OG  대우: B-OG  ##조선: I-OG  ##해: I-OG  ##양: I-OG  전기차: B-AF  
model 2: ▁GM: I-ORG  ▁Korea: I-ORG  ▁대: I-ORG  우: I-ORG  조선: I-ORG  해양: I-ORG  
model 3: 
-----------------------------------
네이버는 최근 카카오와 협력하여 AI 챗봇 기능을 개선하고, 사용자 경험을 극대화할 계획을 발표했습니다.
model 1: 네이버: B-OG  카카오: B-OG  AI: B-TR  ##봇: I-TM  
model 2: ▁네이버: I-ORG  ▁카: I-ORG  카: I-ORG  오: I-ORG  
model 3: 
-----------------------------------
쿠팡은 하림과의 협약을 통해 신선 식품 배송 서비스를 강화하고 있으며, 고객 만족도를 높이는 데 주력하고 있습니다.
model 1: 쿠팡: B-OG  하림: B-OG  
model 2: ▁: I-ORG  쿠: I-ORG  팡: I-ORG  ▁하: I-ORG  림: I-ORG  
model 3: 
-----------------------------------
아모레퍼시픽은 신세계와 함께 뷰티와 라이프스타일을 결합한 새로운 복합 매장을 오픈할 예정입니다.
model 1: 아모레: B-OG  ##퍼: I-OG  ##시: I-OG  ##픽: I-OG  신세계: B-OG  
model 2: ▁아: I-ORG  모: I-ORG  레: I-ORG  퍼: I-ORG  시: I-ORG  픽: I-ORG  ▁신: I-ORG  세계: I-ORG  
model 3: 
-----------------------------------
현대자동차는 효성과의 협력을 통해 전기차 충전 인프라를 확충하고, 친환경 자동차 보급에 힘을 쏟고 있습니다.
model 1: 현대: B-OG  ##자동: B-OG  ##차: I-OG  효성: B-OG  
model 2: ▁현대: I-ORG  자동차: I-ORG  ▁: I-ORG  효: I-ORG  성과: I-ORG  ▁: I-ORG  
model 3: 
-----------------------------------
농협은 동국제약과 손잡고, 건강기능식품 개발에 착수했으며, 이를 통해 농산물의 부가가치를 높이고 있습니다.
model 1: 농협: B-OG  동국: B-OG  ##제: I-OG  ##약: I-OG  
model 2: ▁: I-ORG  농협: I-ORG  ▁동: I-ORG  국: I-ORG  제약: I-ORG  ▁: I-ORG  
model 3: 
-----------------------------------
한국전력공사는 두산중공업과 협력하여 신재생 에너지를 활용한 발전소를 건설하고 있으며, 에너지 전환에 박차를 가하고 있습니다.
model 1: 한국전력: B-OG  ##공사: I-OG  두산: B-OG  ##중: I-OG  ##공업: I-OG  
model 2: ▁한국: I-ORG  전: I-ORG  력: I-ORG  공사: I-ORG  ▁두: I-ORG  산: I-ORG  중: I-ORG  공: I-ORG  업: I-ORG  
model 3: 
-----------------------------------
롯데는 한국수력원자력과 함께 친환경 에너지 솔루션을 도입해 향후 탄소 중립 달성에 기여하고자 합니다.
model 1: 롯데: B-OG  한국: B-OG  ##수: I-OG  ##력: I-OG  ##원: I-OG  탄소: B-MT  
model 2: ▁롯데: I-ORG  ▁한국: I-ORG  수: I-ORG  력: I-ORG  원: I-ORG  자: I-ORG  력: I-ORG  
model 3: 
-----------------------------------
삼양은 CJ제일제당과 협력해 새로운 식품 기술을 개발하고 있으며, 이를 통해 글로벌 식품 시장 진출을 모색하고 있습니다.
model 1: 삼양: B-OG  CJ: B-OG  ##제: I-OG  ##일: I-OG  ##제당: I-OG  
model 2: ▁삼: I-ORG  양: I-ORG  ▁C: I-ORG  J: I-ORG  제: I-ORG  일: I-ORG  제: I-ORG  당: I-ORG  
model 3: 
-----------------------------------
한온시스템은 기아와의 협력을 통해 차세대 전기차에 적용할 냉난방 시스템을 개발하고 있습니다.
model 1: 한: B-OG  ##온: I-OG  ##시스: I-TM  ##템: I-TM  기아: B-OG  전기차: B-AF  
model 2: ▁한: I-ORG  온: I-ORG  시스템: I-ORG  ▁기: I-ORG  아: I-ORG  
model 3: 
-----------------------------------
대한항공은 한화와 손잡고 차세대 무인 항공기 개발에 착수했으며, 글로벌 시장에서의 경쟁력을 높이기 위해 협력을 강화하고 있습니다.
model 1: 대한항공: B-OG  한화: B-OG  무인: B-AF  항공기: I-AF  
model 2: ▁대한: I-ORG  항공: I-ORG  ▁한: I-ORG  화: I-ORG  
model 3: 
-----------------------------------

'''


### gliner
!pip install gliner
!pip install python-mecab-ko


from gliner import GLiNER

model = GLiNER.from_pretrained("taeminlee/gliner_ko")

text = """
피터 잭슨 경(, 1961년 10월 31일 ~ )은 뉴질랜드의 영화 감독, 각본가, 영화 프로듀서이다. J. R. R. 톨킨의 소설을 원작으로 한 《반지의 제왕 영화 3부작》(2001년~2003년)의 감독으로 가장 유명하다. 2005년에는 1933년작 킹콩의 리메이크작 《킹콩(2005)》의 감독을 맡았다.
"""

labels = ["ARTIFACTS", "ANIMAL", "CIVILIZATION", "DATE", "EVENT", "STUDY_FIELD", "LOCATION", "MATERIAL", "ORGANIZATION", "PERSON", "PLANT", "QUANTITY", "TIME", "TERM", "THEORY"]

entities = model.predict_entities(text, labels)

for entity in entities:
    print(entity["text"], "=>", entity["label"])


# Use a pipeline as a high-level helper
from transformers import pipeline

pipe = pipeline("text2text-generation", model="digit82/kobart-summarization")

text = """
1일 오후 9시까지 최소 20만3220명이 코로나19에 신규 확진됐다. 또다시 동시간대 최다 기록으로, 사상 처음 20만명대에 진입했다.
방역 당국과 서울시 등 각 지방자치단체에 따르면 이날 0시부터 오후 9시까지 전국 신규 확진자는 총 20만3220명으로 집계됐다.
국내 신규 확진자 수가 20만명대를 넘어선 것은 이번이 처음이다.
동시간대 최다 기록은 지난 23일 오후 9시 기준 16만1389명이었는데, 이를 무려 4만1831명이나 웃돌았다. 전날 같은 시간 기록한 13만3481명보다도 6만9739명 많다.
확진자 폭증은 3시간 전인 오후 6시 집계에서도 예견됐다.
오후 6시까지 최소 17만8603명이 신규 확진돼 동시간대 최다 기록(24일 13만8419명)을 갈아치운 데 이어 이미 직전 0시 기준 역대 최다 기록도 넘어섰다. 역대 최다 기록은 지난 23일 0시 기준 17만1451명이었다.
17개 지자체별로 보면 서울 4만6938명, 경기 6만7322명, 인천 1만985명 등 수도권이 12만5245명으로 전체의 61.6%를 차지했다. 서울과 경기는 모두 동시간대 기준 최다로, 처음으로 각각 4만명과 6만명을 넘어섰다.
비수도권에서는 7만7975명(38.3%)이 발생했다. 제주를 제외한 나머지 지역에서 모두 동시간대 최다를 새로 썼다.
부산 1만890명, 경남 9909명, 대구 6900명, 경북 6977명, 충남 5900명, 대전 5292명, 전북 5150명, 울산 5141명, 광주 5130명, 전남 4996명, 강원 4932명, 충북 3845명, 제주 1513명, 세종 1400명이다.
집계를 마감하는 자정까지 시간이 남아있는 만큼 2일 0시 기준으로 발표될 신규 확진자 수는 이보다 더 늘어날 수 있다. 이에 따라 최종 집계되는 확진자 수는 21만명 안팎을 기록할 수 있을 전망이다.
한편 전날 하루 선별진료소에서 이뤄진 검사는 70만8763건으로 검사 양성률은 40.5%다. 양성률이 40%를 넘은 것은 이번이 처음이다. 확산세가 계속 거세질 수 있다는 얘기다.
이날 0시 기준 신규 확진자는 13만8993명이었다. 이틀 연속 13만명대를 이어갔다.
"""

text = text.replace('\n', ' ')s